# Дефункционализация

# Пример 1

На прошлой работе нужно было написать интеграционные тесты для проекта. Тесты должны были проверить, что в зависимости от роли пользователя,
его прав, и выполняемого действия, запрос возвращал соответствующий код. Получалась такая картина, что:
1) было n ролей
2) было m прав
3) было k действий

чтобы проверить все-возможные варианты, потребовалось бы написать n*m*k тестов. Я сделал следующим образом:
1) создал список с кредами пользователей
2) написал функцию apply_by_creds, которая принимала в качестве аргументов креды пользователя, лямбда-функцию, выполняющая некоторое действие
от лица пользователя и желаемый код-ответ.

Таким образом, вместо написания n*m*k тестов, у меня вышло порядка 50-ти тестов. 
По мере развития проекта, росло количество прав и ролей, и код тестов быстро начал разрастаться из-за огромного количества лямбда-функций
в аргументах apply_by_creds, причем эти лямбды были между собой очень похожи.

По итогу, сам того не осознавая, я провел дефункционализацию (хотя, скорее анти-унификацию): часто встречащиеся действия, общие для некоторых прав и ролей, вынес в 
переменные:

```php
$ReadDocs = function() use ($user) {
    ...
}

$DeleteDocs = function() use ($user) {
    ...
}

```

К сожалению, на PHP подобная дефункционализация, как мне кажется неактуальна. Во-первых, основной плюс в CPS в сериализации, но я еще не 
застал момент, когда это понадобится в PHP в данный момент; для этого есть более подходящие инструменты и языки. Во-вторых, если забыть про
сериализацию и думать лишь про дефункционализированные функции как про API к тестам, то опять же из-за природы PHP с динамической слабой типизацией это выглядит
проблемно, не всегда понятно будет, какую функцию-API можно использовать в качестве аргумента. В-третьих, выразить функции-API в более
элегантном стиле проблемно.

На тот момент тестами занимался в основном я, и данный подход мне помог не только сократить кодовую базу, но также упростил написание тестов,
за счет того, что определил "язык программирования" для тестов за счет вот этих дефункционализированных функций. 


# Пример 2

