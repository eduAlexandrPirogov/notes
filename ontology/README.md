# Проектные требования или проектная онтология?

# Случай 1


Работал в ТЕЛЕ2 и мы создавали веб-приложение, где можно было управлять тарифами операторов.
Опишу полностью задачу, которую требовалось решить -- создать функционал копирования тарифов. 
Например, на основе 1 тарифа нужно было создать 100 и указать новую цену для них. Чтобы не делать этого руками, решили внедрить данный функционал. 
Отмечу, при копировании требовалось изменить лишь цену и ещё какой-то параметр и всё.

При обсуждении решений с другим разработчиком (пусть будет Олег), вышло так, что забавно, что он выступал за "ориентацию требований", когда как я выступал за "идентификацию поломок".

## с т.зр. онтологии, ориентированной на требования 

Олег предлагал следующее решение: создадим сущность template, как в коде, так и в СУБД в виде отношения.  
Template в виде отношения содержал все атрибуты, присущие тарифам (что означало большое количество null-значений).
При копировании тарифа, достаточно было выбрать шаблон и восполнить пустые поля. При изменении шаблона изменялись бы все атрибуты тарифов, ссылающиеся на этот шаблон.

## с т.зр. "идентификации поломок"

Мне решение это не понравилось по следующим причинам:
1) большое количество null-значение
2) если нужно создать новый экзмепляр template на основе существующего, то либо придется делать alter table, либо это невозможно
3) топорная реализация ориентированная на сущности, которые можно устранить (копироваание не есть существительное, ООАП -- 3 курс).
4) если потребуется установить ограничения на изменение атрибутов, то придется писать либо дополнительный код, либо триггер 
5) зависимость от шаблона. Представьте, что пользователь на основе шаблона Ш1 создал тарифы Т1,Т2...TN, и тариф Т`. Что если нам потребуется изменить все тарифы за исключение T`?
Изменяя шаблон, мы изменим все тарифы. В таком случае придется руками обновлять тарифы Т1,Т2...TN.

Как я рассуждал на тот момент. 
Что такое копирование с изменениями? Это выбор образца, выявление неизменяемых атрибутов (которые копируем), внесение значений в изменяемые атрибуты и создание (тобишь запись в БД).
Явно вырисовывается поток вычислений, и, казалось бы, можно сказать, что это просто механизм, и сущность Template нам вовсе не нужна. Но каким может быть копирование (как в случае с адресом)? Это может быть
поэтапное копирование, когда пользователь постепенно выбирает шаблон (на основе даты, названия и иных атрибутов тарифа) и сохраняет его. И вот тут сущность template уже может понадобиться. 
Но как отразить template в системе, минимизируя зависимость? Сущность template в случае поэтапного копирования можно сохранить в сессии пользователя. 

Чем копирование не является? 
1) Полное копирование тарифа (когда мы копируем все), тем самым выявили инвариант.
2) Новосозданные тарифы НЕ зависят от тарифа-образца, тем самым устраняя зависимость и будущие проблемы.

Модель копирования можно разделить на два этапа в данном случае: сохранение состояния (которые сохраняется в сессии пользователя) и непосредственный механизм копирования (создал процедуру в СУБД). 

## Свои мысли

На что я обратил бы внимание, так это на то, чем копирование НЕ является. В первом случае это создание явной зависимости между новосозданным тарифом и шаблоном, когда как во втором случае 
новосозданный тариф и тариф-образец - независимые сущности. Я не хочу сказать, что Олег предложил ужасное решение. Ключевую роль тут играет контекст. Тарифы - сущности самостоятельные, и изменение одного тарифа не должно влиять на другие.
И копирование именно подразумевает отсутствие зависимости между родителем и дочерним экземпляром. Решение Олега было бы замечательным, где требовалось бы создать конфигурацию для тарифов, где при изменении конфигурации менялись бы
соответствующие тарифы.

# Случай 2


## с т.зр. онтологии, ориентированной на требования



## с т.зр. "идентификации поломок"


# Случай 3

## с т.зр. онтологии, ориентированной на требования

## с т.зр. "идентификации поломок"


# Случай 4

## с т.зр. онтологии, ориентированной на требования

## с т.зр. "идентификации поломок"
